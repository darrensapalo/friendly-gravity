<html>
<head>	
	<title>Friendly Gravity</title>
	<style type="text/css">
	@font-face {
		font-family: 'Space Age';
		src: url('font/spaceage.ttf');
	}
	</style>
	<script src="scripts/lib/tweenjs.js" type="text/javascript"></script>
	
	<script src="scripts/Engine/ImageLoader.js" type="text/javascript"></script>
	<script src="scripts/Engine/Sprite.js" type="text/javascript"></script>
	<script src="scripts/Engine/CenteredSprite.js" type="text/javascript"></script>
	<script src="scripts/Engine/TextSprite.js" type="text/javascript"></script>
	<script src="scripts/Engine/Background.js" type="text/javascript"></script>
	<script src="scripts/Engine/Resources.js" type="text/javascript"></script>

	<script src="scripts/Engine/Game.js" type="text/javascript"></script>
	<script src="scripts/Engine/Config.js" type="text/javascript"></script>

	<script src="scripts/Engine/Color.js" type="text/javascript"></script>
	
	<script src="scripts/Manager/AudioManager.js" type="text/javascript"></script>
	<script src="scripts/Engine/InputHandler.js" type="text/javascript"></script>
	<script src="scripts/Engine/InputState.js" type="text/javascript"></script>
	<script src="scripts/Engine/InputKey.js" type="text/javascript"></script>

	<script src="scripts/Screen/GameScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/GameOverScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/MainMenuScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/ShopScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/TutorialScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/AboutScreen.js" type="text/javascript"></script>
	<script src="scripts/Screen/DevelopScreen.js" type="text/javascript"></script>

	
	<script src="scripts/comet.js" type="text/javascript"></script>
	<script src="scripts/player.js" type="text/javascript"></script>
	<script src="scripts/Trail.js" type="text/javascript"></script>
	<script src="scripts/Planet.js" type="text/javascript"></script>
	
	<script>

	var game = new Game("blackhole", resourceList);
	var DECREASE_SCORE = 50;

	var changeScreenOpacity = 0;

	game.initGame = function () {
		
		game.load();

		game.gameScreen.initialize();
		game.mainMenuScreen.initialize();
		game.shopScreen.initialize();
		game.tutorialScreen.initialize();
		game.aboutScreen.initialize();
		game.developScreen.initialize();

		game.currentScreen = game.mainMenuScreen;


		game.mousex = game.mousey = 0;

		game.displayCometTrail = true;
	}


	game.quit = function () {
		if ("localStorage" in window && window["localStorage"] != null) {
			localStorage["goodblackhole.highscore"] = parseInt(game.highScore);
			localStorage["goodblackhole.cash"] = parseInt(game.cash);

			localStorage["goodblackhole.shockwavecd"] = parseInt(game.shockwavecd);
			localStorage["goodblackhole.difficulty"] = parseInt(game.difficulty);
			localStorage["goodblackhole.pointsRange"] = parseFloat(game.pointsRange);
			localStorage["goodblackhole.gameDuration"] = parseInt(game.gameDuration);
			localStorage["goodblackhole.starMovementSpeed"] = parseFloat(game.starMovementSpeed);

			localStorage["goodblackhole.hasSounds"] = game.hasSounds;
		}
	}

	game.load = function () {
		if ("localStorage" in window && window["localStorage"] != null) {
			if (typeof(localStorage["goodblackhole.highscore"]) != "NaN" && localStorage["goodblackhole.highscore"] != "NaN")
				game.highScore = parseInt(localStorage["goodblackhole.highscore"]);
			else
				game.highScore = 0;
			if (typeof(localStorage["goodblackhole.cash"]) != "undefined" && localStorage["goodblackhole.cash"] != "NaN")
				game.cash = parseInt(localStorage["goodblackhole.cash"]);
			else
				game.cash = 0;


				// Shockwave cooldown 
				if (typeof(localStorage["goodblackhole.shockwavecd"]) != "undefined" && localStorage["goodblackhole.shockwavecd"] != "NaN")
					game.baseShockwaveCooldown = parseInt(localStorage["goodblackhole.shockwavecd"]);
				else
					game.baseShockwaveCooldown = 10000;

				// Difficulty level
				if (typeof(localStorage["goodblackhole.difficulty"]) != "undefined" && localStorage["goodblackhole.difficulty"] != "NaN")
					game.difficulty = parseInt(localStorage["goodblackhole.difficulty"]);
				else
					game.difficulty = 0;

				// Range of points increased
				if (typeof(localStorage["goodblackhole.pointsRange"]) != "undefined" && localStorage["goodblackhole.pointsRange"] != "NaN")
					game.pointsRange = parseFloat(localStorage["goodblackhole.pointsRange"]);
				else
					game.pointsRange = 0.25;

				// Duration of gameplay increased
				if (typeof(localStorage["goodblackhole.gameDuration"]) != "undefined" && localStorage["goodblackhole.gameDuration"] != "NaN")
					game.gameDuration = parseInt(localStorage["goodblackhole.gameDuration"]);
				else
					game.gameDuration = 30;


				// Movement speed of stars is decreased
				if (typeof(localStorage["goodblackhole.starMovementSpeed"]) != "undefined" && localStorage["goodblackhole.starMovementSpeed"] != "NaN")
					game.starMovementSpeed = parseFloat(localStorage["goodblackhole.starMovementSpeed"]);
				else
					game.starMovementSpeed = 0.01;

				// Movement speed of stars is decreased
				if (typeof( localStorage["goodblackhole.hasSounds"]) != "undefined" && localStorage["goodblackhole.hasSounds"] != "NaN")
					game.hasSounds = (localStorage["goodblackhole.hasSounds"] == "true") ? true : false;
				else
					game.hasSounds = true;
			}
		}
		
		game.ResetData = function () {
			game.cash = 0;
			game.highScore = 0;

			game.baseShockwaveCooldown = 10000;
			game.difficulty = 0;
			game.pointsRange = 0.25;
			game.gameDuration = 30;
			game.starMovementSpeed = 0.01;
			game.hasSounds = true;
			game.Quit();
		}
		

		game.draw = function (context) {
			game.clearScreen("#FFFFFF");
			game.currentScreen.draw(context);

			if (game.transferringScreens){
				context.globalAlpha = changeScreenOpacity;
				context.fillStyle = Color.black;
				context.fillRect(0,0,800,480);
				context.globalAlpha = 1;
			}
			
			
			
		}
		game.update = function () {
			game.currentScreen.update();
			game.updateScreenChangeHandler();
			game.AudioManager.manage();
		}
		</script>
	</head>
	<body>
		<div id="page">
			<canvas id="blackhole" width="800" height="480" style="border: 1px solid black"></canvas>
		</div>

		<script> game.start(); </script>
	</body>
	</html>